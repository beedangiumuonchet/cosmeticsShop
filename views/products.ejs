<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Danh S√°ch S·∫£n Ph·∫©m</title>
    <link rel="stylesheet" href="/stylesheets/style.css">
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="/">Trang Ch·ªß</a></li>
                <li><a href="/products">S·∫£n Ph·∫©m</a></li>
                <li><a href="/about">Gi·ªõi Thi·ªáu</a></li>
                <li><a href="/contact">Li√™n H·ªá</a></li>
                <li>
                    <a href="/cart">
                        üõí Gi·ªè h√†ng (<span id="cart-count">0</span>)
                    </a>
                </li>
                <li><a href="/login" class="btn-login">ƒêƒÉng Nh·∫≠p</a></li>
                <li class="user-dropdown" style="display: none;">
                    <a href="#" id="username-display">
                        <i class="fas fa-user-circle"></i> 
                        <span id="dropdown-username">User</span> ‚ñº
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="/profile"><i class="fas fa-user"></i> Th√¥ng tin t√†i kho·∫£n</a></li>
                        <li><a href="/orders"><i class="fas fa-user"></i> ƒê∆°n mua</a></li>
                        <li><a href="#" id="logout-btn"><i class="fas fa-sign-out-alt"></i> ƒêƒÉng xu·∫•t</a></li>
                    </ul>
                </li>
            </ul>
        </nav>
    </header>
    
    
    <!-- B·ªô l·ªçc s·∫£n ph·∫©m -->
    <section class="filters">
        <label for="category">Danh m·ª•c:</label>
        <select id="category">
            <option value="all">T·∫•t c·∫£</option>
            <option value="skincare">ChƒÉm s√≥c da</option>
            <option value="makeup">Trang ƒëi·ªÉm</option>
            <option value="perfume">N∆∞·ªõc hoa</option> <!-- S·ª≠a l·ªói tr√πng value -->
        </select>
    
        <label for="brand">Th∆∞∆°ng hi·ªáu:</label>
        <select id="brand">
            <option value="all">T·∫•t c·∫£</option>
            <option value="brandA">Th∆∞∆°ng hi·ªáu A</option>
            <option value="brandB">Th∆∞∆°ng hi·ªáu B</option>
        </select>
    
        <label for="price">Gi√°:</label>
        <select id="price">
            <option value="all">T·∫•t c·∫£</option>
            <option value="low">D∆∞·ªõi 500k</option>
            <option value="mid">500k - 1 tri·ªáu</option>
            <option value="high">Tr√™n 1 tri·ªáu</option>
        </select>
    </section>
     

    
    <!-- Danh s√°ch s·∫£n ph·∫©m -->
    <section class="product-grid" id="productGrid">
        <!-- S·∫£n ph·∫©m s·∫Ω ƒë∆∞·ª£c load t·ª´ JSON v√†o ƒë√¢y -->
    </section>
    <!-- Modal for Product Details -->
<div id="productModal" class="modal">
    <div class="modal-content">
        <span class="close-btn">&times;</span>
        <h2 id="modal-product-name"></h2>
        <img id="modal-product-image" src="" alt="" />
        <p id="modal-product-description"></p>
        <p id="modal-product-price"></p>
        <button id="add-to-cart-modal" class="add-to-cart">üõí Th√™m v√†o gi·ªè h√†ng</button>
    </div>
</div>

<!-- Th√™m c√°c CSS cho modal -->
<style>
    .modal {
        display: none; /* ·∫®n modal m·∫∑c ƒë·ªãnh */
        position: fixed;
        z-index: 1;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgb(0, 0, 0);
        background-color: rgba(0, 0, 0, 0.4);
    }

    .modal-content {
        background-color: #fefefe;
        margin: 15% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
    }

    .close-btn {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }

    .close-btn:hover,
    .close-btn:focus {
        color: black;
        text-decoration: none;
        cursor: pointer;
    }
</style>

    <!-- products.ejs -->
<script src="/javascripts/products.js"></script> 
<script src="/javascripts/cart.js"></script>
    <script src="/javascripts/login.js">
        document.addEventListener("DOMContentLoaded", () => {
    const loginButton = document.querySelector(".btn-login");
    const userDropdown = document.querySelector(".user-dropdown");
    const usernameDisplay = document.getElementById("dropdown-username");
    const dropdownMenu = document.querySelector(".dropdown-menu");
    const logoutBtn = document.getElementById("logout-btn");

    // Ki·ªÉm tra xem user ƒë√£ ƒëƒÉng nh·∫≠p ch∆∞a
    const loggedInUser = localStorage.getItem("loggedInUser");
    if (loggedInUser) {
        updateNavbar(loggedInUser);
    }

    function updateNavbar(username) {
        loginButton.style.display = "none"; // ·∫®n n√∫t ƒëƒÉng nh·∫≠p
        userDropdown.style.display = "inline-block"; // Hi·ªán dropdown user
        usernameDisplay.textContent = username; // G√°n t√™n user

        // Toggle dropdown menu khi click v√†o username
        document.getElementById("username-display").addEventListener("click", function (event) {
            event.preventDefault();
            dropdownMenu.style.display = dropdownMenu.style.display === "block" ? "none" : "block";
        });

        // ƒê√≥ng dropdown khi click b√™n ngo√†i
        document.addEventListener("click", function (event) {
            if (!userDropdown.contains(event.target)) {
                dropdownMenu.style.display = "none";
            }
        });
    }

    // X·ª≠ l√Ω ƒëƒÉng xu·∫•t
    logoutBtn?.addEventListener("click", function (event) {
        event.preventDefault();
        localStorage.removeItem("loggedInUser");
        window.location.href = "/login"; // Chuy·ªÉn h∆∞·ªõng v·ªÅ trang ƒëƒÉng nh·∫≠p
    });
});
    </script>
</body>
</html>
